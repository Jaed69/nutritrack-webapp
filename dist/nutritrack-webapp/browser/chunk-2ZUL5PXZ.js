import{a as U}from"./chunk-5ZQY3ATP.js";import{a as R}from"./chunk-MUQBBXYO.js";import{a as F,b as A,d as D,f as T,r as j}from"./chunk-YUBUCD23.js";import"./chunk-6LZ2YNEV.js";import{A as f,Aa as k,B as w,K as p,L as g,N as C,O as x,P as v,Q as i,R as t,W as I,Y as _,_ as u,aa as P,ca as r,da as d,ea as b,ga as h,ha as M,ia as O,ka as E,o as S,p as y,ra as N,u as m,y as s,za as L}from"./chunk-S3CJXT6Z.js";import"./chunk-2VMXMS7J.js";var W=o=>["/admin/planes",o,"editar"],G=o=>["/admin/planes",o,"dias"],q=(o,n)=>n.id;function V(o,n){o&1&&(i(0,"div",9),r(1,"Cargando planes..."),t())}function B(o,n){o&1&&(i(0,"div",10)(1,"p"),r(2,"No hay planes registrados"),t(),i(3,"button",2),r(4," Crear el primer plan "),t()())}function $(o,n){if(o&1&&(i(0,"div",21)(1,"span",19),r(2,"Usuarios activos:"),t(),i(3,"span",20),r(4),t()()),o&2){let e=u().$implicit;s(4),d(e.numeroUsuariosActivos)}}function Y(o,n){if(o&1&&(i(0,"span",23),r(1),t()),o&2){let e=n.$implicit;s(),d(e.nombre)}}function H(o,n){if(o&1){let e=I();i(0,"div",13)(1,"div",14)(2,"h3"),r(3),t(),i(4,"span",15),r(5),t()(),i(6,"p",16),r(7),t(),i(8,"div",17)(9,"div",18)(10,"span",19),r(11,"Duraci\xF3n:"),t(),i(12,"span",20),r(13),t()(),i(14,"div",18)(15,"span",19),r(16,"Objetivo:"),t(),i(17,"span",20),r(18),t()(),i(19,"div",18)(20,"span",19),r(21,"Calor\xEDas:"),t(),i(22,"span",20),r(23),t()(),p(24,$,5,1,"div",21),t(),i(25,"div",22),C(26,Y,2,1,"span",23,q),t(),i(28,"div",24)(29,"button",25),r(30," Editar "),t(),i(31,"button",25),r(32," Configurar D\xEDas "),t(),i(33,"button",26),_("click",function(){let c=S(e).$implicit,l=u(2);return y(l.confirmarEliminar(c))}),r(34," Eliminar "),t()()()}if(o&2){let e=n.$implicit,a=u(2);P("inactivo",!e.activo),s(3),d(e.nombre),s(),P("badge-inactive",!e.activo),s(),b(" ",e.activo?"Activo":"Inactivo"," "),s(2),d(e.descripcion),s(6),b("",e.duracionDias," d\xEDas"),s(5),d(a.formatearObjetivo(e.objetivo.tipoObjetivo)),s(5),b("",e.objetivo.caloriasObjetivo," kcal"),s(),g(e.numeroUsuariosActivos!==void 0&&e.numeroUsuariosActivos>0?24:-1),s(2),x(e.etiquetas),s(3),v("routerLink",E(14,W,e.id)),s(2),v("routerLink",E(16,G,e.id)),s(2),v("disabled",e.numeroUsuariosActivos&&e.numeroUsuariosActivos>0)}}function J(o,n){if(o&1&&(i(0,"div",11),C(1,H,35,18,"div",12,q),t()),o&2){let e=u();s(),x(e.planesFiltrados())}}var z=class o{constructor(n,e,a){this.planService=n;this.notificationService=e;this.router=a}loading=m(!1);mostrarInactivos=m(!1);filtroNombre=m("");planesFiltrados=m([]);ngOnInit(){this.cargarPlanes()}cargarPlanes(){this.loading.set(!0),this.planService.obtenerPlanes(this.mostrarInactivos()).subscribe({next:n=>{this.loading.set(!1),n.success&&this.planesFiltrados.set(n.data||[])},error:()=>{this.loading.set(!1),this.notificationService.showError("Error al cargar planes")}})}filtrarPlanes(){let n=this.planService.planes(),e=this.filtroNombre().toLowerCase();if(!e){this.planesFiltrados.set(n);return}let a=n.filter(c=>c.nombre.toLowerCase().includes(e)||c.descripcion.toLowerCase().includes(e));this.planesFiltrados.set(a)}confirmarEliminar(n){if(n.numeroUsuariosActivos&&n.numeroUsuariosActivos>0){this.notificationService.showError(`No puedes eliminar este plan porque ${n.numeroUsuariosActivos} usuario(s) lo tienen activo (RN14)`);return}confirm(`\xBFEst\xE1s seguro de eliminar el plan "${n.nombre}"?

Esta acci\xF3n no se puede deshacer.`)&&this.planService.eliminarPlan(n.id).subscribe({next:a=>{a.success&&(this.notificationService.showSuccess("Plan eliminado exitosamente"),this.cargarPlanes())},error:a=>{a.status===409?this.notificationService.showError(a.error.message||"El plan tiene usuarios activos"):this.notificationService.showError("Error al eliminar plan")}})}formatearObjetivo(n){return{PERDIDA_PESO:"P\xE9rdida de Peso",GANANCIA_MUSCULAR:"Ganancia Muscular",MANTENIMIENTO:"Mantenimiento",DEFINICION:"Definici\xF3n",SALUD_GENERAL:"Salud General"}[n]||n}static \u0275fac=function(e){return new(e||o)(f(U),f(R),f(L))};static \u0275cmp=w({type:o,selectors:[["app-lista-planes"]],decls:17,vars:5,consts:[[1,"planes-container"],[1,"header"],["routerLink","/admin/planes/crear",1,"btn-primary"],[1,"icon"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Buscar por nombre...",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"loading"],[1,"empty-state"],[1,"planes-grid"],[1,"plan-card",3,"inactivo"],[1,"plan-card"],[1,"plan-header"],[1,"badge"],[1,"plan-description"],[1,"plan-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"stat","usuarios-activos"],[1,"plan-etiquetas"],[1,"etiqueta"],[1,"plan-actions"],[1,"btn-secondary",3,"routerLink"],[1,"btn-danger",3,"click","disabled"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Gesti\xF3n de Planes Nutricionales"),t(),i(4,"button",2)(5,"i",3),r(6,"+"),t(),r(7," Crear Plan "),t()(),i(8,"div",4)(9,"div",5)(10,"input",6),O("ngModelChange",function(l){return M(a.filtroNombre,l)||(a.filtroNombre=l),l}),_("ngModelChange",function(){return a.filtrarPlanes()}),t()(),i(11,"label",7)(12,"input",8),O("ngModelChange",function(l){return M(a.mostrarInactivos,l)||(a.mostrarInactivos=l),l}),_("ngModelChange",function(){return a.cargarPlanes()}),t(),r(13," Mostrar planes inactivos "),t()(),p(14,V,2,0,"div",9),p(15,B,5,0,"div",10),p(16,J,3,0,"div",11),t()),e&2&&(s(10),h("ngModel",a.filtroNombre),s(2),h("ngModel",a.mostrarInactivos),s(2),g(a.loading()?14:-1),s(),g(!a.loading()&&a.planesFiltrados().length===0?15:-1),s(),g(!a.loading()&&a.planesFiltrados().length>0?16:-1))},dependencies:[N,k,j,A,F,D,T],styles:[".planes-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}h1[_ngcontent-%COMP%]{font-size:2rem;color:#2d3748;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;align-items:center}.search-box[_ngcontent-%COMP%]{flex:1;max-width:400px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.planes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.plan-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;transition:transform .2s,box-shadow .2s}.plan-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.plan-card.inactivo[_ngcontent-%COMP%]{opacity:.7;background:#f7fafc}.plan-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem}.plan-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#2d3748;flex:1}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.875rem;font-weight:600;background:#48bb78;color:#fff}.badge-inactive[_ngcontent-%COMP%]{background:#cbd5e0;color:#4a5568}.plan-description[_ngcontent-%COMP%]{color:#718096;margin-bottom:1rem;line-height:1.5}.plan-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1rem;padding:1rem;background:#f7fafc;border-radius:8px}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#718096;margin-bottom:.25rem}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#2d3748}.usuarios-activos[_ngcontent-%COMP%]{grid-column:1 / -1;background:#fed7d7;padding:.5rem;border-radius:6px}.usuarios-activos[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#c53030}.plan-etiquetas[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.etiqueta[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#edf2f7;color:#4a5568;border-radius:20px;font-size:.875rem}.plan-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568;flex:1}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-danger[_ngcontent-%COMP%]{background:#fc8181;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#f56565}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#718096}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.125rem;margin-bottom:1rem}.icon[_ngcontent-%COMP%]{font-size:1.25rem;margin-right:.25rem}"]})};export{z as ListaPlanesComponent};
