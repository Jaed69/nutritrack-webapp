import{a as U}from"./chunk-NMCC4XAY.js";import{a as z}from"./chunk-MUQBBXYO.js";import{a as L,b as F,d as A,f as T,r as D}from"./chunk-YUBUCD23.js";import"./chunk-6LZ2YNEV.js";import{A as f,Aa as k,B as R,K as u,L as p,N as C,O as x,P as v,Q as i,R as e,W as w,Y as _,_ as g,aa as h,ca as o,da as l,ea as b,ga as M,ha as P,ia as O,ka as S,o as E,p as y,ra as I,u as m,y as s,za as N}from"./chunk-S3CJXT6Z.js";import"./chunk-2VMXMS7J.js";var V=r=>["/admin/rutinas",r,"editar"],W=r=>["/admin/rutinas",r,"ejercicios"],q=(r,n)=>n.id;function B(r,n){r&1&&(i(0,"div",9),o(1,"Cargando rutinas..."),e())}function $(r,n){r&1&&(i(0,"div",10)(1,"p"),o(2,"No hay rutinas registradas"),e(),i(3,"button",2),o(4," Crear la primera rutina "),e()())}function G(r,n){if(r&1&&(i(0,"div",21)(1,"span",19),o(2,"Usuarios activos:"),e(),i(3,"span",20),o(4),e()()),r&2){let t=g().$implicit;s(4),l(t.numeroUsuariosActivos)}}function Y(r,n){if(r&1&&(i(0,"span",23),o(1),e()),r&2){let t=n.$implicit;s(),l(t.nombre)}}function Z(r,n){if(r&1){let t=w();i(0,"div",13)(1,"div",14)(2,"h3"),o(3),e(),i(4,"span",15),o(5),e()(),i(6,"p",16),o(7),e(),i(8,"div",17)(9,"div",18)(10,"span",19),o(11,"Duraci\xF3n:"),e(),i(12,"span",20),o(13),e()(),i(14,"div",18)(15,"span",19),o(16,"Nivel:"),e(),i(17,"span",20),o(18),e()(),i(19,"div",18)(20,"span",19),o(21,"Frecuencia:"),e(),i(22,"span",20),o(23),e()(),u(24,G,5,1,"div",21),e(),i(25,"div",22),C(26,Y,2,1,"span",23,q),e(),i(28,"div",24)(29,"button",25),o(30," Editar "),e(),i(31,"button",25),o(32," Gestionar Ejercicios "),e(),i(33,"button",26),_("click",function(){let d=E(t).$implicit,c=g(2);return y(c.confirmarEliminar(d))}),o(34," Eliminar "),e()()()}if(r&2){let t=n.$implicit,a=g(2);h("inactiva",!t.activo),s(3),l(t.nombre),s(),h("badge-inactive",!t.activo),s(),b(" ",t.activo?"Activa":"Inactiva"," "),s(2),l(t.descripcion),s(6),b("",t.duracionSemanas," semanas"),s(5),l(a.formatearNivel(t.nivelDificultad)),s(5),b("",t.frecuenciaSemanal,"x semana"),s(),p(t.numeroUsuariosActivos!==void 0&&t.numeroUsuariosActivos>0?24:-1),s(2),x(t.etiquetas),s(3),v("routerLink",S(14,V,t.id)),s(2),v("routerLink",S(16,W,t.id)),s(2),v("disabled",t.numeroUsuariosActivos&&t.numeroUsuariosActivos>0)}}function H(r,n){if(r&1&&(i(0,"div",11),C(1,Z,35,18,"div",12,q),e()),r&2){let t=g();s(),x(t.rutinasFiltradas())}}var j=class r{constructor(n,t,a){this.rutinaService=n;this.notificationService=t;this.router=a}loading=m(!1);mostrarInactivas=m(!1);filtroNombre=m("");rutinasFiltradas=m([]);ngOnInit(){this.cargarRutinas()}cargarRutinas(){this.loading.set(!0),this.rutinaService.obtenerRutinas(this.mostrarInactivas()).subscribe({next:n=>{this.loading.set(!1),n.success&&this.rutinasFiltradas.set(n.data||[])},error:()=>{this.loading.set(!1),this.notificationService.showError("Error al cargar rutinas")}})}filtrarRutinas(){let n=this.rutinaService.rutinas(),t=this.filtroNombre().toLowerCase();if(!t){this.rutinasFiltradas.set(n);return}let a=n.filter(d=>d.nombre.toLowerCase().includes(t)||d.descripcion.toLowerCase().includes(t));this.rutinasFiltradas.set(a)}confirmarEliminar(n){if(n.numeroUsuariosActivos&&n.numeroUsuariosActivos>0){this.notificationService.showError(`No puedes eliminar esta rutina porque ${n.numeroUsuariosActivos} usuario(s) la tienen activa (RN14)`);return}confirm(`\xBFEst\xE1s seguro de eliminar la rutina "${n.nombre}"?

Esta acci\xF3n no se puede deshacer.`)&&this.rutinaService.eliminarRutina(n.id).subscribe({next:a=>{a.success&&(this.notificationService.showSuccess("Rutina eliminada exitosamente"),this.cargarRutinas())},error:a=>{a.status===409?this.notificationService.showError(a.error.message||"La rutina tiene usuarios activos"):this.notificationService.showError("Error al eliminar rutina")}})}formatearNivel(n){return{PRINCIPIANTE:"Principiante",INTERMEDIO:"Intermedio",AVANZADO:"Avanzado"}[n]||n}static \u0275fac=function(t){return new(t||r)(f(U),f(z),f(N))};static \u0275cmp=R({type:r,selectors:[["app-lista-rutinas"]],decls:17,vars:5,consts:[[1,"rutinas-container"],[1,"header"],["routerLink","/admin/rutinas/crear",1,"btn-primary"],[1,"icon"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Buscar por nombre...",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"loading"],[1,"empty-state"],[1,"rutinas-grid"],[1,"rutina-card",3,"inactiva"],[1,"rutina-card"],[1,"rutina-header"],[1,"badge"],[1,"rutina-description"],[1,"rutina-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"stat","usuarios-activos"],[1,"rutina-etiquetas"],[1,"etiqueta"],[1,"rutina-actions"],[1,"btn-secondary",3,"routerLink"],[1,"btn-danger",3,"click","disabled"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),o(3,"Gesti\xF3n de Rutinas de Ejercicio"),e(),i(4,"button",2)(5,"i",3),o(6,"+"),e(),o(7," Crear Rutina "),e()(),i(8,"div",4)(9,"div",5)(10,"input",6),O("ngModelChange",function(c){return P(a.filtroNombre,c)||(a.filtroNombre=c),c}),_("ngModelChange",function(){return a.filtrarRutinas()}),e()(),i(11,"label",7)(12,"input",8),O("ngModelChange",function(c){return P(a.mostrarInactivas,c)||(a.mostrarInactivas=c),c}),_("ngModelChange",function(){return a.cargarRutinas()}),e(),o(13," Mostrar rutinas inactivas "),e()(),u(14,B,2,0,"div",9),u(15,$,5,0,"div",10),u(16,H,3,0,"div",11),e()),t&2&&(s(10),M("ngModel",a.filtroNombre),s(2),M("ngModel",a.mostrarInactivas),s(2),p(a.loading()?14:-1),s(),p(!a.loading()&&a.rutinasFiltradas().length===0?15:-1),s(),p(!a.loading()&&a.rutinasFiltradas().length>0?16:-1))},dependencies:[I,k,D,F,L,A,T],styles:[".rutinas-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}h1[_ngcontent-%COMP%]{font-size:2rem;color:#2d3748;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;align-items:center}.search-box[_ngcontent-%COMP%]{flex:1;max-width:400px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.rutinas-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.rutina-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;transition:transform .2s,box-shadow .2s}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.rutina-card.inactiva[_ngcontent-%COMP%]{opacity:.7;background:#f7fafc}.rutina-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem}.rutina-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#2d3748;flex:1}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.875rem;font-weight:600;background:#48bb78;color:#fff}.badge-inactive[_ngcontent-%COMP%]{background:#cbd5e0;color:#4a5568}.rutina-description[_ngcontent-%COMP%]{color:#718096;margin-bottom:1rem;line-height:1.5}.rutina-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1rem;padding:1rem;background:#f7fafc;border-radius:8px}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#718096;margin-bottom:.25rem}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#2d3748}.usuarios-activos[_ngcontent-%COMP%]{grid-column:1 / -1;background:#fed7d7;padding:.5rem;border-radius:6px}.usuarios-activos[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#c53030}.rutina-etiquetas[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.etiqueta[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#edf2f7;color:#4a5568;border-radius:20px;font-size:.875rem}.rutina-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568;flex:1}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-danger[_ngcontent-%COMP%]{background:#fc8181;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#f56565}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#718096}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.125rem;margin-bottom:1rem}.icon[_ngcontent-%COMP%]{font-size:1.25rem;margin-right:.25rem}"]})};export{j as ListaRutinasComponent};
